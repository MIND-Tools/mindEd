<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     26 fÃ©vr. 2010 10:03:39                                                        

     mind-IDE    
     build generated files emf, gmf, xtext ...
                   
     Stephane Chomat, ADELE                                                                
     ====================================================================== -->
<project name="mind-IDE" default="generate" xmlns:gmf="http://ecliptical.ca/gmf/ant">
	<description>
            build generated files emf, gmf, xtext ...
    </description>

	<!-- ================================= 
          target: generate              
	  install this support  http://www.eclipticalsoftware.com/updates/site.xml
	  run this ant script in running eclipse
         ================================= -->
	<target name="generate" depends="" description="build generated files emf, gmf, xtext ...">
		<property name="model-dir" value="${basedir}/../org.ow2.fractal.mind.emf/model">
		</property>
		<property name="emf-project" value="${basedir}/../org.ow2.fractal.mind.emf.model" />
		<property name="emf-edit-project" value="${basedir}/../org.ow2.fractal.mind.emf.model.edit" />
		<property name="emf-editor-project" value="${basedir}/../org.ow2.fractal.mind.emf.model.editor" />
		<property name="gmf-project" value ="${basedir}/../org.ow2.fractal.mind.gmf"/>
		
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model" depth="infinite"/>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model.edit" depth="infinite"/>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model.editor" depth="infinite"/>
		
		<emf.Ecore2Java genModel="${model-dir}/mind.genmodel" model="${model-dir}/mind.ecore" 
			generatejavacode="true" 
			generateeditorproject="false" 
			generateeditproject="false"
			generatemodelproject="true"
			reconcilegenmodel="reload"
			>
		</emf.Ecore2Java>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model" depth="infinite"/>
		<emf.Ecore2Java genModel="${model-dir}/mind.genmodel" model="${model-dir}/mind.ecore" 
					generatejavacode="true" 
					generateeditorproject="true" 
					generateeditproject="true"
					generatemodelproject="false"
					reconcilegenmodel="keep"
					>
				</emf.Ecore2Java>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model.edit" depth="infinite"/>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.model.editor" depth="infinite"/>
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.diagram" depth="infinite"/>
		<eclipse.incrementalBuild project="org.ow2.fractal.mind.emf.model" kind="incremental"/>
		<eclipse.incrementalBuild project="org.ow2.fractal.mind.emf.model.edit" kind="incremental"/>
		<eclipse.incrementalBuild project="org.ow2.fractal.mind.emf.model.editor" kind="incremental"/>

					
		<gmf:GenerateDiagramCode gmfgenPath="org.ow2.fractal.mind.gmf/model/mind.gmfgen" />
		
		<eclipse.refreshLocal resource="org.ow2.fractal.mind.emf.diagram" depth="infinite"/>
				
		
		<!-- 
		<echo message="Generating source code from xText grammar (using oAW)"/>
		
		<taskdef name="workflow" classname="org.eclipse.emf.mwe.core.ant.WorkflowAntTask">
			<classpath>
				<fileset dir="${eclipse.home}/plugins"></fileset>
			</classpath>
		</taskdef>
		<workflow file='path/workflow.mwe'>
			<param name='baseDir' value='/base/'/>
			<classpath refid="@dot.classpath"/>
		</workflow> 
		
		-->
		
	</target>

	<target name="clean">
		<property name="model-dir" value="${basedir}/../org.ow2.fractal.mind.emf/model">
		</property>
		<property name="emf-project" value="${basedir}/../org.ow2.fractal.mind.emf.model" />
		<property name="emf-edit-project" value="${basedir}/../org.ow2.fractal.mind.emf.model.edit" />
		<property name="emf-editor-project" value="${basedir}/../org.ow2.fractal.mind.emf.model.editor" />
		<property name="org.ow2.fractal.mind.emf.diagram" value="${basedir}/../org.ow2.fractal.mind.emf.diagram" />
				
		<delete dir="${emf-project}/src"/>
		<mkdir dir="${emf-project}/src" />
		<delete dir="${emf-edit-project}/src"/>
		<mkdir dir="${emf-edit-project}/src" />
		<delete dir="${emf-editor-project}/src"/>
		<mkdir dir="${emf-editor-project}/src" />
		<mkdir dir="${org.ow2.fractal.mind.emf.diagram}/src" />

	</target>

</project>
